#!/bin/bash

# ЁЯЫбя╕П Advanced Web Vulnerability Scanner with Email Support (Gmail SMTP)
# тЪая╕П For authorized and ethical use only.

echo "ЁЯМР ржУрзЯрзЗржмрж╕рж╛ржЗржЯ ржЯрж╛рж░рзНржЧрзЗржЯ ржжрж┐ржи (e.g., http://example.com):"
read target

echo "ЁЯУз ржЖржкржирж╛рж░ ржЗржорзЗржЗрж▓ (ржЦрж╛рж▓рж┐ рж░рж╛ржЦрж▓рзЗ рж░рж┐ржкрзЛрж░рзНржЯ рж╕рзЗржн рж╣ржмрзЗ ржХрж┐ржирзНрждрзБ ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗ ржирж╛):"
read email

timestamp=$(date +%Y%m%d_%H%M%S)
report_dir=~/webscan_reports/scan_$timestamp
mkdir -p $report_dir

# STEP 1: Nikto
echo "ЁЯФН Nikto ржжрж┐рзЯрзЗ рж╕рзНржХрзНржпрж╛ржи рж╢рзБрж░рзБ рж╣ржЪрзНржЫрзЗ..."
nikto -host $target -Format htm -output $report_dir/nikto.html

# STEP 2: Nmap
echo "ЁЯФН Nmap ржжрж┐рзЯрзЗ рж╕рж╛рж░рзНржнрж┐рж╕ ржУ ржнрж╛рж░рзНрж╕ржи рж╕рзНржХрзНржпрж╛ржи ржЪрж▓ржЫрзЗ..."
nmap -sV -T4 -Pn $target -oN $report_dir/nmap.txt

# STEP 3: Dirb
echo "ЁЯФН Dirb ржжрж┐рзЯрзЗ рж╣рж┐ржбрзЗржи ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ ржЦрзЛржБржЬрж╛ рж╣ржЪрзНржЫрзЗ..."
dirb $target -o $report_dir/dirb.txt

# STEP 4: Extract Nmap services
echo "ЁЯза рж╕рж╛рж░рзНржнрж┐рж╕ рж▓рж┐рж╕рзНржЯ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ..."
grep -E "^[0-9]+/tcp" $report_dir/nmap.txt | awk '{print $3, $4}' > $report_dir/services.txt

# STEP 5: Compress Reports
zip -r $report_dir.zip $report_dir > /dev/null

# STEP 6: Email Report if email provided
if [[ "$email" != "" ]]; then
    echo "ЁЯУд рж░рж┐ржкрзЛрж░рзНржЯ ржкрж╛ржарж╛ржирзЛ рж╣ржЪрзНржЫрзЗ $email ржП..."

    echo "ЁЯЫбя╕П Web Vulnerability Scan Report for $target is attached." | mutt -s "ЁЯзк WebScan Report [$target]" -a "$report_dir.zip" -- "$email"

    echo "тЬЕ рж░рж┐ржкрзЛрж░рзНржЯ рж╕ржлрж▓ржнрж╛ржмрзЗ ржкрж╛ржарж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ!"
else
    echo "ЁЯУБ рж░рж┐ржкрзЛрж░рзНржЯ рж╕ржВрж░ржХрзНрж╖рж┐ржд: $report_dir"
    echo "ЁЯУм ржЗржорзЗржЗрж▓ ржкрж╛ржарж╛ржирзЛ рж╣рзЯржирж┐ (ржЗржорзЗржЗрж▓ ржЦрж╛рж▓рж┐ ржЫрж┐рж▓)"
fi
